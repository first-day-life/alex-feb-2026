<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Landing Page Explorer</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Password gate -->
  <div id="lock-screen">
    <div class="lock-card">
      <div class="lock-icon">
        <svg width="40" height="40" viewBox="0 0 40 40" fill="none"><rect x="8" y="18" width="24" height="18" rx="3" stroke="currentColor" stroke-width="2.5"/><path d="M14 18v-5a6 6 0 1 1 12 0v5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/><circle cx="20" cy="28" r="2.5" fill="currentColor"/></svg>
      </div>
      <h2>Meta LPs Explorer</h2>
      <p>Enter the password to continue</p>
      <form id="lock-form" autocomplete="off">
        <input type="password" id="lock-input" placeholder="Password" autofocus>
        <button type="submit" class="btn btn-primary">Enter</button>
      </form>
      <p id="lock-error" class="lock-error hidden">Wrong password — try again</p>
    </div>
  </div>

  <div id="app" class="hidden">
    <!-- Top bar -->
    <header id="header">
      <div class="header-left">
        <button id="sidebar-toggle" class="icon-btn" aria-label="Toggle sidebar">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><rect y="3" width="20" height="2" rx="1" fill="currentColor"/><rect y="9" width="20" height="2" rx="1" fill="currentColor"/><rect y="15" width="20" height="2" rx="1" fill="currentColor"/></svg>
        </button>
        <h1 class="logo">Meta LPs Explorer</h1>
      </div>
      <div class="header-center">
        <div class="search-box">
          <svg class="search-icon" width="16" height="16" viewBox="0 0 16 16" fill="none"><circle cx="7" cy="7" r="5.5" stroke="currentColor" stroke-width="1.5"/><line x1="11" y1="11" x2="14.5" y2="14.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
          <input type="text" id="search" placeholder="Search pages..." autocomplete="off">
        </div>
      </div>
      <div class="header-right">
        <div class="sort-group">
          <label for="sort-select">Sort:</label>
          <select id="sort-select">
            <option value="sessions-desc">Sessions (high)</option>
            <option value="sessions-asc">Sessions (low)</option>
            <option value="cvr-desc">CVR (high)</option>
            <option value="cvr-asc">CVR (low)</option>
            <option value="bounce-desc">Bounce (high)</option>
            <option value="bounce-asc">Bounce (low)</option>
          </select>
        </div>
        <button id="settings-btn" class="icon-btn" aria-label="Settings">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="2.5" stroke="currentColor" stroke-width="1.5"/><path d="M10 1.5v2m0 13v2m-6-8.5h-2m15 0h2m-3.4-5.1 1.4-1.4m-11.4 11.4 1.4-1.4m9.6 0 1.4 1.4M4.6 4.6 3.1 3.1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </div>
    </header>

    <!-- Settings modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h2>Connect Your Google Sheet</h2>
        <p class="modal-desc">Publish your sheet to the web (<strong>File &gt; Share &gt; Publish to web &gt; CSV</strong>), then paste the URL below.</p>
        <input type="text" id="sheet-url" placeholder="https://docs.google.com/spreadsheets/d/e/2PACX-1vRCpN6f4J91aFKu9PFdPyqkWxc_q96mYif3JyCY9zI2C4VmoNHULLTvpa-XDOS_fkV9cIn2_0RfYZ_E/pub?gid=592398799&single=true&output=csv" autocomplete="off">
        <div class="column-mapping">
          <h3>Column Mapping</h3>
          <p class="modal-desc">Enter the exact header names from your sheet.</p>
          <div class="mapping-grid">
            <label>URL column<input type="text" id="col-url" value="landing_page_path" placeholder="landing_page_path"></label>
            <label>Page name column<input type="text" id="col-name" value="landing_page_name" placeholder="landing_page_name"></label>
            <label>CVR column<input type="text" id="col-cvr" value="conversion_rate" placeholder="conversion_rate"></label>
            <label>Bounce Rate column<input type="text" id="col-bounce" value="bounce_rate" placeholder="bounce_rate"></label>
            <label>Sessions column<input type="text" id="col-sessions" value="sessions" placeholder="sessions"></label>
          </div>
        </div>
        <div class="modal-actions">
          <button id="settings-cancel" class="btn btn-ghost">Cancel</button>
          <button id="settings-save" class="btn btn-primary">Load Sheet</button>
        </div>
      </div>
    </div>

    <!-- Main layout -->
    <div id="main">
      <!-- Sidebar with page list -->
      <aside id="sidebar" class="open">
        <div id="summary-bar">
          <div class="summary-stat">
            <span class="summary-value" id="total-pages">0</span>
            <span class="summary-label">Pages</span>
          </div>
          <div class="summary-stat">
            <span class="summary-value" id="avg-cvr">0%</span>
            <span class="summary-label">Avg CVR</span>
          </div>
          <div class="summary-stat">
            <span class="summary-value" id="total-sessions">0</span>
            <span class="summary-label">Sessions</span>
          </div>
        </div>
        <ul id="page-list"></ul>
      </aside>

      <!-- Preview area -->
      <section id="preview-area">
        <div id="preview-frame-wrap" class="hidden">
          <div id="frame-toolbar">
            <div class="frame-url-bar">
              <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><circle cx="7" cy="7" r="5.5" stroke="currentColor" stroke-width="1.2"/><path d="M7 1.5C7 1.5 4 5 4 7s3 5.5 3 5.5m0-11c0 0 3 3.5 3 5.5S7 12.5 7 12.5M1.5 7h11" stroke="currentColor" stroke-width="1.2"/></svg>
              <span id="frame-url"></span>
              <a id="frame-external" href="#" target="_blank" rel="noopener" aria-label="Open in new tab">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M6 2H3a1 1 0 00-1 1v8a1 1 0 001 1h8a1 1 0 001-1V8m-4-6h4m0 0v4m0-4L7 7" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </a>
            </div>
            <div class="frame-toolbar-note">Opens in a new tab</div>
          </div>
          <div id="frame-container">
            <div id="funnel">
              <div class="funnel-header">
                <div class="funnel-title">Purchase Funnel</div>
                <div class="funnel-page">
                  <div class="funnel-page-name" id="funnel-page-name">—</div>
                  <div class="funnel-page-url" id="funnel-page-url">—</div>
                </div>
                <div class="funnel-kpis">
                  <div class="funnel-kpi">
                    <span class="funnel-kpi-value" id="funnel-cvr">0.0%</span>
                    <span class="funnel-kpi-label">Conversion Rate</span>
                  </div>
                  <div class="funnel-kpi">
                    <span class="funnel-kpi-value" id="funnel-sessions">0</span>
                    <span class="funnel-kpi-label">Sessions</span>
                  </div>
                  <div class="funnel-kpi">
                    <span class="funnel-kpi-value" id="funnel-completed-sessions">0</span>
                    <span class="funnel-kpi-label">Completed</span>
                  </div>
                </div>
              </div>

              <div class="funnel-steps">
                <div class="funnel-step">
                  <div class="funnel-step-label">Sessions</div>
                  <div class="funnel-step-metrics">
                    <span class="funnel-step-pct" id="funnel-sessions-pct">100.0%</span>
                    <span class="funnel-step-count" id="funnel-sessions-count">0</span>
                  </div>
                  <div class="funnel-step-bar">
                    <div class="funnel-step-bar-fill" id="funnel-sessions-bar" style="width: 100%"></div>
                  </div>
                </div>

                <div class="funnel-step">
                  <div class="funnel-step-label">Did Not Bounce</div>
                  <div class="funnel-step-metrics">
                    <span class="funnel-step-pct" id="funnel-nonbounce-pct">0.0%</span>
                    <span class="funnel-step-count" id="funnel-nonbounce-count">0</span>
                  </div>
                  <div class="funnel-step-dropoff">
                    <span class="funnel-step-dropoff-label">Drop-off</span>
                    <span class="funnel-step-dropoff-value" id="funnel-nonbounce-dropoff">0 (0.0%)</span>
                  </div>
                  <div class="funnel-step-bar">
                    <div class="funnel-step-bar-fill" id="funnel-nonbounce-bar"></div>
                  </div>
                </div>

                <div class="funnel-step">
                  <div class="funnel-step-label">Added to Cart</div>
                  <div class="funnel-step-metrics">
                    <span class="funnel-step-pct" id="funnel-added-pct">0.0%</span>
                    <span class="funnel-step-count" id="funnel-added-count">0</span>
                  </div>
                  <div class="funnel-step-dropoff">
                    <span class="funnel-step-dropoff-label">Drop-off</span>
                    <span class="funnel-step-dropoff-value" id="funnel-added-dropoff">0 (0.0%)</span>
                  </div>
                  <div class="funnel-step-bar">
                    <div class="funnel-step-bar-fill" id="funnel-added-bar"></div>
                  </div>
                </div>

                <div class="funnel-step">
                  <div class="funnel-step-label">Reached Checkout</div>
                  <div class="funnel-step-metrics">
                    <span class="funnel-step-pct" id="funnel-reached-pct">0.0%</span>
                    <span class="funnel-step-count" id="funnel-reached-count">0</span>
                  </div>
                  <div class="funnel-step-dropoff">
                    <span class="funnel-step-dropoff-label">Drop-off</span>
                    <span class="funnel-step-dropoff-value" id="funnel-reached-dropoff">0 (0.0%)</span>
                  </div>
                  <div class="funnel-step-bar">
                    <div class="funnel-step-bar-fill" id="funnel-reached-bar"></div>
                  </div>
                </div>

                <div class="funnel-step">
                  <div class="funnel-step-label">Completed Checkout</div>
                  <div class="funnel-step-metrics">
                    <span class="funnel-step-pct" id="funnel-completed-pct">0.0%</span>
                    <span class="funnel-step-count" id="funnel-completed-count">0</span>
                  </div>
                  <div class="funnel-step-dropoff">
                    <span class="funnel-step-dropoff-label">Drop-off</span>
                    <span class="funnel-step-dropoff-value" id="funnel-completed-dropoff">0 (0.0%)</span>
                  </div>
                  <div class="funnel-step-bar">
                    <div class="funnel-step-bar-fill" id="funnel-completed-bar"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
